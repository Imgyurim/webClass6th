(this.webpackJsonpwaffle=this.webpackJsonpwaffle||[]).push([[51],{1057:function(Xn,_,tt){"use strict";tt.r(_),tt.d(_,"basicLogger",function(){return Bn}),tt.d(_,"createConsoleLogger",function(){return Gn}),tt.d(_,"default",function(){return Wn}),tt.d(_,"initialize",function(){return we}),tt.d(_,"version",function(){return be});function Z(t){function n(i,r){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=i,this.code=r}return n.prototype=new Error,n.prototype.name=t,n.prototype.constructor=n,n}const Ie=Z("LaunchDarklyUnexpectedResponseError"),Oe=Z("LaunchDarklyInvalidEnvironmentIdError"),Le=Z("LaunchDarklyInvalidUserError"),Ue=Z("LaunchDarklyInvalidEventKeyError"),Te=Z("LaunchDarklyInvalidArgumentError"),Re=Z("LaunchDarklyFlagFetchError");for(var F={LDUnexpectedResponseError:Ie,LDInvalidEnvironmentIdError:Oe,LDInvalidUserError:Le,LDInvalidEventKeyError:Ue,LDInvalidArgumentError:Te,LDInvalidDataError:Z("LaunchDarklyInvalidDataError"),LDFlagFetchError:Re,isHttpErrorRecoverable:function(t){return!(t>=400&&t<500)||t===400||t===408||t===429}},Ae=function(t){var n=Gt(t),i=n[0],r=n[1];return 3*(i+r)/4-r},je=function(t){var n,i,r=Gt(t),c=r[0],e=r[1],o=new Fe(function(u,l,d){return 3*(l+d)/4-d}(0,c,e)),a=0,s=e>0?c-4:c;for(i=0;i<s;i+=4)n=G[t.charCodeAt(i)]<<18|G[t.charCodeAt(i+1)]<<12|G[t.charCodeAt(i+2)]<<6|G[t.charCodeAt(i+3)],o[a++]=n>>16&255,o[a++]=n>>8&255,o[a++]=255&n;return e===2&&(n=G[t.charCodeAt(i)]<<2|G[t.charCodeAt(i+1)]>>4,o[a++]=255&n),e===1&&(n=G[t.charCodeAt(i)]<<10|G[t.charCodeAt(i+1)]<<4|G[t.charCodeAt(i+2)]>>2,o[a++]=n>>8&255,o[a++]=255&n),o},Ne=function(t){for(var n,i=t.length,r=i%3,c=[],e=16383,o=0,a=i-r;o<a;o+=e)c.push(Ve(t,o,o+e>a?a:o+e));return r===1?(n=t[i-1],c.push(Y[n>>2]+Y[n<<4&63]+"==")):r===2&&(n=(t[i-2]<<8)+t[i-1],c.push(Y[n>>10]+Y[n>>4&63]+Y[n<<2&63]+"=")),c.join("")},Y=[],G=[],Fe=typeof Uint8Array!="undefined"?Uint8Array:Array,bt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et=0,$e=bt.length;et<$e;++et)Y[et]=bt[et],G[bt.charCodeAt(et)]=et;function Gt(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return i===-1&&(i=n),[i,i===n?0:4-i%4]}function Ve(t,n,i){for(var r,c,e=[],o=n;o<i;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),e.push(Y[(c=r)>>18&63]+Y[c>>12&63]+Y[c>>6&63]+Y[63&c]);return e.join("")}G["-".charCodeAt(0)]=62,G["_".charCodeAt(0)]=63;var He={byteLength:Ae,toByteArray:je,fromByteArray:Ne},Wt=Array.isArray,Xt=Object.keys,Me=Object.prototype.hasOwnProperty,qe=function t(n,i){if(n===i)return!0;if(n&&i&&typeof n=="object"&&typeof i=="object"){var r,c,e,o=Wt(n),a=Wt(i);if(o&&a){if((c=n.length)!=i.length)return!1;for(r=c;r--!=0;)if(!t(n[r],i[r]))return!1;return!0}if(o!=a)return!1;var s=n instanceof Date,u=i instanceof Date;if(s!=u)return!1;if(s&&u)return n.getTime()==i.getTime();var l=n instanceof RegExp,d=i instanceof RegExp;if(l!=d)return!1;if(l&&d)return n.toString()==i.toString();var g=Xt(n);if((c=g.length)!==Xt(i).length)return!1;for(r=c;r--!=0;)if(!Me.call(i,g[r]))return!1;for(r=c;r--!=0;)if(!t(n[e=g[r]],i[e]))return!1;return!0}return n!=n&&i!=i};const Ke=["key","ip","country","email","firstName","lastName","avatar","name"];function Yt(t){const n=unescape(encodeURIComponent(t));return He.fromByteArray(function(i){const r=[];for(let c=0;c<i.length;c++)r.push(i.charCodeAt(c));return r}(n))}function Qt(t){return Yt(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function kt(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var Et,D={appendUrlPath:function(t,n){return(t.endsWith("/")?t.substring(0,t.length-1):t)+(n.startsWith("/")?"":"/")+n},base64URLEncode:Qt,btoa:Yt,chunkEventsForUrl:function(t,n){const i=n.slice(0),r=[];let c,e=t;for(;i.length>0;){for(c=[];e>0;){const o=i.shift();if(!o)break;e-=Qt(JSON.stringify(o)).length,e<0&&c.length>0?i.unshift(o):c.push(o)}e=t,r.push(c)}return r},clone:function(t){return JSON.parse(JSON.stringify(t))},deepEquals:function(t,n){return qe(t,n)},extend:function(...t){return t.reduce((n,i)=>({...n,...i}),{})},getLDUserAgentString:function(t){const n=t.version||"?";return t.userAgent+"/"+n},objectHasOwnProperty:kt,onNextTick:function(t){setTimeout(t,0)},sanitizeContext:function(t){if(!t)return t;let n;return t.kind!==null&&t.kind!==void 0||Ke.forEach(i=>{const r=t[i];r!==void 0&&typeof r!="string"&&(n=n||{...t},n[i]=String(r))}),n||t},transformValuesToVersionedValues:function(t){const n={};for(const i in t)kt(t,i)&&(n[i]={value:t[i],version:0});return n},transformVersionedValuesToValues:function(t){const n={};for(const i in t)kt(t,i)&&(n[i]=t[i].value);return n},wrapPromiseCallback:function(t,n){const i=t.then(r=>(n&&setTimeout(()=>{n(null,r)},0),r),r=>{if(!n)return Promise.reject(r);setTimeout(()=>{n(r,null)},0)});return n?void 0:i}},Je=new Uint8Array(16);function Zt(){if(!Et&&!(Et=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Et(Je)}var ze=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ut(t){return typeof t=="string"&&ze.test(t)}for(var _t,Dt,H=[],Ct=0;Ct<256;++Ct)H.push((Ct+256).toString(16).substr(1));function lt(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(H[t[n+0]]+H[t[n+1]]+H[t[n+2]]+H[t[n+3]]+"-"+H[t[n+4]]+H[t[n+5]]+"-"+H[t[n+6]]+H[t[n+7]]+"-"+H[t[n+8]]+H[t[n+9]]+"-"+H[t[n+10]]+H[t[n+11]]+H[t[n+12]]+H[t[n+13]]+H[t[n+14]]+H[t[n+15]]).toLowerCase();if(!ut(i))throw TypeError("Stringified UUID is invalid");return i}var xt=0,Pt=0;function te(t){if(!ut(t))throw TypeError("Invalid UUID");var n,i=new Uint8Array(16);return i[0]=(n=parseInt(t.slice(0,8),16))>>>24,i[1]=n>>>16&255,i[2]=n>>>8&255,i[3]=255&n,i[4]=(n=parseInt(t.slice(9,13),16))>>>8,i[5]=255&n,i[6]=(n=parseInt(t.slice(14,18),16))>>>8,i[7]=255&n,i[8]=(n=parseInt(t.slice(19,23),16))>>>8,i[9]=255&n,i[10]=(n=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=n/4294967296&255,i[12]=n>>>24&255,i[13]=n>>>16&255,i[14]=n>>>8&255,i[15]=255&n,i}function ee(t,n,i){function r(c,e,o,a){if(typeof c=="string"&&(c=function(l){l=unescape(encodeURIComponent(l));for(var d=[],g=0;g<l.length;++g)d.push(l.charCodeAt(g));return d}(c)),typeof e=="string"&&(e=te(e)),e.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+c.length);if(s.set(e),s.set(c,e.length),(s=i(s))[6]=15&s[6]|n,s[8]=63&s[8]|128,o){a=a||0;for(var u=0;u<16;++u)o[a+u]=s[u];return o}return lt(s)}try{r.name=t}catch(c){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function ne(t){return 14+(t+64>>>9<<4)+1}function Q(t,n){var i=(65535&t)+(65535&n);return(t>>16)+(n>>16)+(i>>16)<<16|65535&i}function dt(t,n,i,r,c,e){return Q((o=Q(Q(n,t),Q(r,e)))<<(a=c)|o>>>32-a,i);var o,a}function M(t,n,i,r,c,e,o){return dt(n&i|~n&r,t,n,c,e,o)}function q(t,n,i,r,c,e,o){return dt(n&r|i&~r,t,n,c,e,o)}function K(t,n,i,r,c,e,o){return dt(n^i^r,t,n,c,e,o)}function J(t,n,i,r,c,e,o){return dt(i^(n|~r),t,n,c,e,o)}var Be=ee("v3",48,function(t){if(typeof t=="string"){var n=unescape(encodeURIComponent(t));t=new Uint8Array(n.length);for(var i=0;i<n.length;++i)t[i]=n.charCodeAt(i)}return function(r){for(var c=[],e=32*r.length,o="0123456789abcdef",a=0;a<e;a+=8){var s=r[a>>5]>>>a%32&255,u=parseInt(o.charAt(s>>>4&15)+o.charAt(15&s),16);c.push(u)}return c}(function(r,c){r[c>>5]|=128<<c%32,r[ne(c)-1]=c;for(var e=1732584193,o=-271733879,a=-1732584194,s=271733878,u=0;u<r.length;u+=16){var l=e,d=o,g=a,m=s;e=M(e,o,a,s,r[u],7,-680876936),s=M(s,e,o,a,r[u+1],12,-389564586),a=M(a,s,e,o,r[u+2],17,606105819),o=M(o,a,s,e,r[u+3],22,-1044525330),e=M(e,o,a,s,r[u+4],7,-176418897),s=M(s,e,o,a,r[u+5],12,1200080426),a=M(a,s,e,o,r[u+6],17,-1473231341),o=M(o,a,s,e,r[u+7],22,-45705983),e=M(e,o,a,s,r[u+8],7,1770035416),s=M(s,e,o,a,r[u+9],12,-1958414417),a=M(a,s,e,o,r[u+10],17,-42063),o=M(o,a,s,e,r[u+11],22,-1990404162),e=M(e,o,a,s,r[u+12],7,1804603682),s=M(s,e,o,a,r[u+13],12,-40341101),a=M(a,s,e,o,r[u+14],17,-1502002290),e=q(e,o=M(o,a,s,e,r[u+15],22,1236535329),a,s,r[u+1],5,-165796510),s=q(s,e,o,a,r[u+6],9,-1069501632),a=q(a,s,e,o,r[u+11],14,643717713),o=q(o,a,s,e,r[u],20,-373897302),e=q(e,o,a,s,r[u+5],5,-701558691),s=q(s,e,o,a,r[u+10],9,38016083),a=q(a,s,e,o,r[u+15],14,-660478335),o=q(o,a,s,e,r[u+4],20,-405537848),e=q(e,o,a,s,r[u+9],5,568446438),s=q(s,e,o,a,r[u+14],9,-1019803690),a=q(a,s,e,o,r[u+3],14,-187363961),o=q(o,a,s,e,r[u+8],20,1163531501),e=q(e,o,a,s,r[u+13],5,-1444681467),s=q(s,e,o,a,r[u+2],9,-51403784),a=q(a,s,e,o,r[u+7],14,1735328473),e=K(e,o=q(o,a,s,e,r[u+12],20,-1926607734),a,s,r[u+5],4,-378558),s=K(s,e,o,a,r[u+8],11,-2022574463),a=K(a,s,e,o,r[u+11],16,1839030562),o=K(o,a,s,e,r[u+14],23,-35309556),e=K(e,o,a,s,r[u+1],4,-1530992060),s=K(s,e,o,a,r[u+4],11,1272893353),a=K(a,s,e,o,r[u+7],16,-155497632),o=K(o,a,s,e,r[u+10],23,-1094730640),e=K(e,o,a,s,r[u+13],4,681279174),s=K(s,e,o,a,r[u],11,-358537222),a=K(a,s,e,o,r[u+3],16,-722521979),o=K(o,a,s,e,r[u+6],23,76029189),e=K(e,o,a,s,r[u+9],4,-640364487),s=K(s,e,o,a,r[u+12],11,-421815835),a=K(a,s,e,o,r[u+15],16,530742520),e=J(e,o=K(o,a,s,e,r[u+2],23,-995338651),a,s,r[u],6,-198630844),s=J(s,e,o,a,r[u+7],10,1126891415),a=J(a,s,e,o,r[u+14],15,-1416354905),o=J(o,a,s,e,r[u+5],21,-57434055),e=J(e,o,a,s,r[u+12],6,1700485571),s=J(s,e,o,a,r[u+3],10,-1894986606),a=J(a,s,e,o,r[u+10],15,-1051523),o=J(o,a,s,e,r[u+1],21,-2054922799),e=J(e,o,a,s,r[u+8],6,1873313359),s=J(s,e,o,a,r[u+15],10,-30611744),a=J(a,s,e,o,r[u+6],15,-1560198380),o=J(o,a,s,e,r[u+13],21,1309151649),e=J(e,o,a,s,r[u+4],6,-145523070),s=J(s,e,o,a,r[u+11],10,-1120210379),a=J(a,s,e,o,r[u+2],15,718787259),o=J(o,a,s,e,r[u+9],21,-343485551),e=Q(e,l),o=Q(o,d),a=Q(a,g),s=Q(s,m)}return[e,o,a,s]}(function(r){if(r.length===0)return[];for(var c=8*r.length,e=new Uint32Array(ne(c)),o=0;o<c;o+=8)e[o>>5]|=(255&r[o/8])<<o%32;return e}(t),8*t.length))}),Ge=Be;function We(t,n,i,r){switch(t){case 0:return n&i^~n&r;case 1:case 3:return n^i^r;case 2:return n&i^n&r^i&r}}function St(t,n){return t<<n|t>>>32-n}var Xe=ee("v5",80,function(t){var n=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var c=0;c<r.length;++c)t.push(r.charCodeAt(c))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var e=t.length/4+2,o=Math.ceil(e/16),a=new Array(o),s=0;s<o;++s){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=t[64*s+4*l]<<24|t[64*s+4*l+1]<<16|t[64*s+4*l+2]<<8|t[64*s+4*l+3];a[s]=u}a[o-1][14]=8*(t.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(t.length-1)&4294967295;for(var d=0;d<o;++d){for(var g=new Uint32Array(80),m=0;m<16;++m)g[m]=a[d][m];for(var h=16;h<80;++h)g[h]=St(g[h-3]^g[h-8]^g[h-14]^g[h-16],1);for(var b=i[0],P=i[1],y=i[2],w=i[3],O=i[4],T=0;T<80;++T){var S=Math.floor(T/20),N=St(b,5)+We(S,P,y,w)+O+n[S]+g[T]>>>0;O=w,w=y,y=St(P,30)>>>0,P=b,b=N}i[0]=i[0]+b>>>0,i[1]=i[1]+P>>>0,i[2]=i[2]+y>>>0,i[3]=i[3]+w>>>0,i[4]=i[4]+O>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]}),Ye=Xe,It=Object.freeze({__proto__:null,v1:function(t,n,i){var r=n&&i||0,c=n||new Array(16),e=(t=t||{}).node||_t,o=t.clockseq!==void 0?t.clockseq:Dt;if(e==null||o==null){var a=t.random||(t.rng||Zt)();e==null&&(e=_t=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=Dt=16383&(a[6]<<8|a[7]))}var s=t.msecs!==void 0?t.msecs:Date.now(),u=t.nsecs!==void 0?t.nsecs:Pt+1,l=s-xt+(u-Pt)/1e4;if(l<0&&t.clockseq===void 0&&(o=o+1&16383),(l<0||s>xt)&&t.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");xt=s,Pt=u,Dt=o;var d=(1e4*(268435455&(s+=122192928e5))+u)%4294967296;c[r++]=d>>>24&255,c[r++]=d>>>16&255,c[r++]=d>>>8&255,c[r++]=255&d;var g=s/4294967296*1e4&268435455;c[r++]=g>>>8&255,c[r++]=255&g,c[r++]=g>>>24&15|16,c[r++]=g>>>16&255,c[r++]=o>>>8|128,c[r++]=255&o;for(var m=0;m<6;++m)c[r+m]=e[m];return n||lt(c)},v3:Ge,v4:function(t,n,i){var r=(t=t||{}).random||(t.rng||Zt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){i=i||0;for(var c=0;c<16;++c)n[i+c]=r[c];return n}return lt(r)},v5:Ye,NIL:"00000000-0000-0000-0000-000000000000",version:function(t){if(!ut(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)},validate:ut,stringify:lt,parse:te});const at=["debug","info","warn","error","none"];var Ot={commonBasicLogger:function(t,n){if(t&&t.destination&&typeof t.destination!="function")throw new Error("destination for basicLogger was set to a non-function");function i(u){return function(l){console&&console[u]&&console[u].call(console,l)}}const r=t&&t.destination?[t.destination,t.destination,t.destination,t.destination]:[i("log"),i("info"),i("warn"),i("error")],c=!(!t||!t.destination),e=t&&t.prefix!==void 0&&t.prefix!==null?t.prefix:"[LaunchDarkly] ";let o=1;if(t&&t.level)for(let u=0;u<at.length;u++)at[u]===t.level&&(o=u);function a(u,l,d){if(d.length<1)return;let g;const m=c?l+": "+e:e;if(d.length!==1&&n){const h=[...d];h[0]=m+h[0],g=n(...h)}else g=m+d[0];try{r[u](g)}catch(h){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+l+" method threw an exception: "+h)}}const s={};for(let u=0;u<at.length;u++){const l=at[u];if(l!=="none")if(u<o)s[l]=()=>{};else{const d=u;s[l]=function(){a(d,l,arguments)}}}return s},validateLogger:function(t){at.forEach(n=>{if(n!=="none"&&(!t[n]||typeof t[n]!="function"))throw new Error("Provided logger instance must support logger."+n+"(...) method")})}};function ft(t){return t&&t.message?t.message:typeof t=="string"||t instanceof String?t:JSON.stringify(t)}const nt=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.";var E={bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},bootstrapOldFormat:function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+nt},clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},debugEnqueueingEvent:function(t){return'enqueueing "'+t+'" event'},debugPostingDiagnosticEvent:function(t){return"sending diagnostic event ("+t.kind+")"},debugPostingEvents:function(t){return"sending "+t+" events"},debugStreamDelete:function(t){return'received streaming deletion for flag "'+t+'"'},debugStreamDeleteIgnored:function(t){return'received streaming deletion for flag "'+t+'" but ignored due to version check'},debugStreamPatch:function(t){return'received streaming update for flag "'+t+'"'},debugStreamPatchIgnored:function(t){return'received streaming update for flag "'+t+'" but ignored due to version check'},debugStreamPing:function(){return"received ping message from stream"},debugPolling:function(t){return"polling for feature flags at "+t},debugStreamPut:function(){return"received streaming update for all flags"},deprecated:function(t,n){return n?'"'+t+'" is deprecated, please use "'+n+'"':'"'+t+'" is deprecated'},environmentNotFound:function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+nt},environmentNotSpecified:function(){return"No environment/client-side ID was specified."+nt},errorFetchingFlags:function(t){return"Error fetching flag settings: "+ft(t)},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutContext:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},httpErrorMessage:function(t,n,i){return"Received error "+t+(t===401?" (invalid SDK key)":"")+" for "+n+" - "+(F.isHttpErrorRecoverable(t)?i:"giving up permanently")},httpUnavailable:function(){return"Cannot make HTTP requests in this environment."+nt},identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},inspectorMethodError:(t,n)=>`an inspector: "${n}" of type: "${t}" generated an exception`,invalidContentType:function(t){return'Expected application/json content type but got "'+t+'"'},invalidData:function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},invalidInspector:(t,n)=>`an inspector: "${n}" of an invalid type (${t}) was configured`,invalidKey:function(){return"Event key must be a string"},invalidContext:function(){return"Invalid context specified."+nt},invalidTagValue:t=>`Config option "${t}" must only contain letters, numbers, ., _ or -.`,localStorageUnavailable:function(t){return"local storage is unavailable: "+ft(t)},networkError:t=>"network error"+(t?" ("+t+")":""),optionBelowMinimum:(t,n,i)=>'Config option "'+t+'" was set to '+n+", changing to minimum value of "+i,streamClosing:function(){return"Closing stream connection"},streamConnecting:function(t){return"Opening stream connection to "+t},streamError:function(t,n){return"Error on stream connection: "+ft(t)+", will continue retrying after "+n+" milliseconds."},tagValueTooLong:t=>`Value of "${t}" was longer than 64 characters and was discarded.`,unknownCustomEventKey:function(t){return'Custom event "'+t+'" does not exist'},unknownOption:t=>'Ignoring unknown config option "'+t+'"',contextNotSpecified:function(){return"No context specified."+nt},unrecoverableStreamError:t=>`Error on stream connection ${ft(t)}, giving up permanently`,wrongOptionType:(t,n,i)=>'Config option "'+t+'" should be of type '+n+", got "+i+", using default value",wrongOptionTypeBoolean:(t,n)=>'Config option "'+t+'" should be a boolean, got '+n+", converting to boolean"};const{validateLogger:Qe}=Ot,re={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributes:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},application:{validator:function(t,n,i){const r={};return n.id&&(r.id=oe(`${t}.id`,n.id,i)),n.version&&(r.version=oe(`${t}.version`,n.version,i)),r}},inspectors:{default:[]}},Ze=/^(\w|\.|-)+$/;function Lt(t){return t&&t.replace(/\/+$/,"")}function oe(t,n,i){if(typeof n=="string"&&n.match(Ze)){if(!(n.length>64))return n;i.warn(E.tagValueTooLong(t))}else i.warn(E.invalidTagValue(t))}var Ut={baseOptionDefs:re,validate:function(t,n,i,r){const c=D.extend({logger:{default:r}},re,i),e={};function o(s){D.onNextTick(()=>{n&&n.maybeReportError(new F.LDInvalidArgumentError(s))})}let a=D.extend({},t||{});return function(s){const u=s;Object.keys(e).forEach(l=>{if(u[l]!==void 0){const d=e[l];r&&r.warn(E.deprecated(l,d)),d&&(u[d]===void 0&&(u[d]=u[l]),delete u[l])}})}(a),a=function(s){const u=D.extend({},s);return Object.keys(c).forEach(l=>{u[l]!==void 0&&u[l]!==null||(u[l]=c[l]&&c[l].default)}),u}(a),a=function(s){const u=D.extend({},s),l=d=>{if(d===null)return"any";if(d===void 0)return;if(Array.isArray(d))return"array";const g=typeof d;return g==="boolean"||g==="string"||g==="number"||g==="function"?g:"object"};return Object.keys(s).forEach(d=>{const g=s[d];if(g!=null){const m=c[d];if(m===void 0)o(E.unknownOption(d));else{const h=m.type||l(m.default),b=m.validator;if(b){const P=b(d,s[d],r);P!==void 0?u[d]=P:delete u[d]}else if(h!=="any"){const P=h.split("|"),y=l(g);P.indexOf(y)<0?h==="boolean"?(u[d]=!!g,o(E.wrongOptionTypeBoolean(d,y))):(o(E.wrongOptionType(d,h,y)),u[d]=m.default):y==="number"&&m.minimum!==void 0&&g<m.minimum&&(o(E.optionBelowMinimum(d,g,m.minimum)),u[d]=m.minimum)}}}}),u.baseUrl=Lt(u.baseUrl),u.streamUrl=Lt(u.streamUrl),u.eventsUrl=Lt(u.eventsUrl),u}(a),Qe(a.logger),a},getTags:function(t){const n={};return t&&(t.application&&t.application.id!==void 0&&t.application.id!==null&&(n["application-id"]=[t.application.id]),t.application&&t.application.version!==void 0&&t.application.id!==null&&(n["application-version"]=[t.application.version])),n}};const{getLDUserAgentString:_e}=D;var Tt={getLDHeaders:function(t,n){if(n&&!n.sendLDHeaders)return{};const i={};i[t.userAgentHeaderName||"User-Agent"]=_e(t),n&&n.wrapperName&&(i["X-LaunchDarkly-Wrapper"]=n.wrapperVersion?n.wrapperName+"/"+n.wrapperVersion:n.wrapperName);const r=Ut.getTags(n),c=Object.keys(r);return c.length&&(i["x-launchdarkly-tags"]=c.sort().map(e=>Array.isArray(r[e])?r[e].sort().map(o=>`${e}/${o}`):[`${e}/${r[e]}`]).reduce((e,o)=>e.concat(o),[]).join(" ")),i},transformHeaders:function(t,n){return n&&n.requestHeaderTransform?n.requestHeaderTransform({...t}):t}};const{v1:tn}=It,{getLDHeaders:en,transformHeaders:nn}=Tt;var ie=function(t,n,i){const r="/a/"+n+".gif",c=D.extend({"Content-Type":"application/json"},en(t,i)),e=t.httpFallbackPing,o={};return o.sendChunk=(a,s,u,l)=>{const d=JSON.stringify(a),g=u?null:tn();return l?function m(h){const b=u?c:D.extend({},c,{"X-LaunchDarkly-Event-Schema":"4","X-LaunchDarkly-Payload-ID":g});return t.httpRequest("POST",s,nn(b,i),d).promise.then(P=>{if(P)return P.status>=400&&F.isHttpErrorRecoverable(P.status)&&h?m(!1):function(y){const w={status:y.status},O=y.header("date");if(O){const T=Date.parse(O);T&&(w.serverTime=T)}return w}(P)}).catch(()=>h?m(!1):Promise.reject())}(!0).catch(()=>{}):(e&&e(s+r+"?d="+D.base64URLEncode(d)),Promise.resolve())},o.sendEvents=function(a,s,u){if(!t.httpRequest)return Promise.resolve();const l=t.httpAllowsPost();let d;d=l?[a]:D.chunkEventsForUrl(2e3-s.length,a);const g=[];for(let m=0;m<d.length;m++)g.push(o.sendChunk(d[m],s,u,l));return Promise.all(g)},o};const{commonBasicLogger:rn}=Ot;function ae(t){return typeof t=="string"&&t!=="kind"&&t.match(/^(\w|\.|-)+$/)}function se(t){return t.includes("%")||t.includes(":")?t.replace(/%/g,"%25").replace(/:/g,"%3A"):t}var gt={checkContext:function(t,n){if(t){if(n&&(t.kind===void 0||t.kind===null))return t.key!==void 0&&t.key!==null;const i=t.key,r=t.kind===void 0?"user":t.kind,c=ae(r),e=r==="multi"||i!=null&&i!=="";if(r==="multi"){const o=Object.keys(t).filter(a=>a!=="kind");return e&&o.every(a=>ae(a))&&o.every(a=>{const s=t[a].key;return s!=null&&s!==""})}return e&&c}return!1},getContextKeys:function(t,n=rn()){if(!t)return;const i={},{kind:r,key:c}=t;switch(r){case void 0:i.user=`${c}`;break;case"multi":Object.entries(t).filter(([e])=>e!=="kind").forEach(([e,o])=>{o&&o.key&&(i[e]=o.key)});break;case null:n.warn(`null is not a valid context kind: ${t}`);break;case"":n.warn(`'' is not a valid context kind: ${t}`);break;default:i[r]=`${c}`}return i},getContextKinds:function(t){return t?t.kind===null||t.kind===void 0?["user"]:t.kind!=="multi"?[t.kind]:Object.keys(t).filter(n=>n!=="kind"):[]},getCanonicalKey:function(t){if(t){if((t.kind===void 0||t.kind===null||t.kind==="user")&&t.key)return t.key;if(t.kind!=="multi"&&t.key)return`${t.kind}:${se(t.key)}`;if(t.kind==="multi")return Object.keys(t).sort().filter(n=>n!=="kind").map(n=>`${n}:${se(t[n].key)}`).join(":")}}};const{getContextKinds:on}=gt;var an=function(){const t={};let n=0,i=0,r={},c={};return t.summarizeEvent=e=>{if(e.kind==="feature"){const o=e.key+":"+(e.variation!==null&&e.variation!==void 0?e.variation:"")+":"+(e.version!==null&&e.version!==void 0?e.version:""),a=r[o];let s=c[e.key];s||(s=new Set,c[e.key]=s),function(u){return u.context?on(u.context):u.contextKeys?Object.keys(u.contextKeys):[]}(e).forEach(u=>s.add(u)),a?a.count=a.count+1:r[o]={count:1,key:e.key,version:e.version,variation:e.variation,value:e.value,default:e.default},(n===0||e.creationDate<n)&&(n=e.creationDate),e.creationDate>i&&(i=e.creationDate)}},t.getSummary=()=>{const e={};let o=!0;for(const a of Object.values(r)){let s=e[a.key];s||(s={default:a.default,counters:[],contextKinds:[...c[a.key]]},e[a.key]=s);const u={value:a.value,count:a.count};a.variation!==void 0&&a.variation!==null&&(u.variation=a.variation),a.version!==void 0&&a.version!==null?u.version=a.version:u.unknown=!0,s.counters.push(u),o=!1}return o?null:{startDate:n,endDate:i,features:e}},t.clearSummary=()=>{n=0,i=0,r={},c={}},t};function ce(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function ue(t){return(t.startsWith("/")?t.substring(1):t).split("/").map(n=>n.indexOf("~")>=0?n.replace(/~1/g,"/").replace(/~0/g,"~"):n)}function le(t){return!t.startsWith("/")}function de(t,n){const i=le(t),r=le(n);if(i&&r)return t===n;if(i){const c=ue(n);return c.length===1&&t===c[0]}if(r){const c=ue(t);return c.length===1&&n===c[0]}return t===n}function fe(t){return`/${ce(t)}`}var Rt={cloneExcluding:function(t,n){const i=[],r={},c=[];for(i.push(...Object.keys(t).map(e=>({key:e,ptr:fe(e),source:t,parent:r,visited:[t]})));i.length;){const e=i.pop();if(n.some(o=>de(o,e.ptr)))c.push(e.ptr);else{const o=e.source[e.key];if(o===null)e.parent[e.key]=o;else if(Array.isArray(o))e.parent[e.key]=[...o];else if(typeof o=="object"){if(e.visited.includes(o))continue;e.parent[e.key]={},i.push(...Object.keys(o).map(a=>{return{key:a,ptr:(s=e.ptr,u=ce(a),`${s}/${u}`),source:o,parent:e.parent[e.key],visited:[...e.visited,o]};var s,u}))}else e.parent[e.key]=o}}return{cloned:r,excluded:c.sort()}},compare:de,literalToReference:fe},sn=function(t){const n={},i=t.allAttributesPrivate,r=t.privateAttributes||[],c=["key","kind","_meta","anonymous"],e=["name","ip","firstName","lastName","email","avatar","country"],o=a=>{if(typeof a!="object"||a===null||Array.isArray(a))return;const{cloned:s,excluded:u}=Rt.cloneExcluding(a,(l=>(i?Object.keys(l):[...r,...l._meta&&l._meta.privateAttributes||[]]).filter(d=>!c.some(g=>Rt.compare(d,g))))(a));return s.key=String(s.key),u.length&&(s._meta||(s._meta={}),s._meta.redactedAttributes=u),s._meta&&(delete s._meta.privateAttributes,Object.keys(s._meta).length===0&&delete s._meta),s.anonymous!==void 0&&(s.anonymous=!!s.anonymous),s};return n.filter=a=>a.kind===void 0||a.kind===null?o((s=>{const u={...s.custom||{},kind:"user",key:s.key};s.anonymous!==void 0&&(u.anonymous=!!s.anonymous);for(const l of e)delete u[l],s[l]!==void 0&&s[l]!==null&&(u[l]=String(s[l]));return s.privateAttributeNames!==void 0&&s.privateAttributeNames!==null&&(u._meta=u._meta||{},u._meta.privateAttributes=s.privateAttributeNames.map(l=>l.startsWith("/")?Rt.literalToReference(l):l)),u})(a)):a.kind==="multi"?(s=>{const u={kind:s.kind},l=Object.keys(s);for(const d of l)if(d!=="kind"){const g=o(s[d]);g&&(u[d]=g)}return u})(a):o(a),n};const{getContextKeys:cn}=gt;var un=function(t,n,i,r=null,c=null,e=null){const o={},a=e||ie(t,i,n),s=D.appendUrlPath(n.eventsUrl,"/events/bulk/"+i),u=an(),l=sn(n),d=n.samplingInterval,g=n.eventCapacity,m=n.flushInterval,h=n.logger;let b,P=[],y=0,w=!1,O=!1;function T(){return d===0||Math.floor(Math.random()*d)===0}function S(C){const A=D.extend({},C);return C.kind==="identify"?A.context=l.filter(C.context):(A.contextKeys=cn(C.context,h),delete A.context),C.kind==="feature"&&(delete A.trackEvents,delete A.debugEventsUntilDate),A}function N(C){P.length<g?(P.push(C),O=!1):(O||(O=!0,h.warn(E.eventCapacityExceeded())),r&&r.incrementDroppedEvents())}return o.enqueue=function(C){if(w)return;let A=!1,k=!1;var x;if(u.summarizeEvent(C),C.kind==="feature"?T()&&(A=!!C.trackEvents,k=!!(x=C).debugEventsUntilDate&&x.debugEventsUntilDate>y&&x.debugEventsUntilDate>new Date().getTime()):A=T(),A&&N(S(C)),k){const R=D.extend({},C,{kind:"debug"});R.context=l.filter(R.context),delete R.trackEvents,delete R.debugEventsUntilDate,N(R)}},o.flush=function(){if(w)return Promise.resolve();const C=P,A=u.getSummary();return u.clearSummary(),A&&(A.kind="summary",C.push(A)),r&&r.setEventsInLastBatch(C.length),C.length===0?Promise.resolve():(P=[],h.debug(E.debugPostingEvents(C.length)),a.sendEvents(C,s).then(k=>{const x=k&&k[0];x&&(x.serverTime&&(y=x.serverTime),F.isHttpErrorRecoverable(x.status)||(w=!0),x.status>=400&&D.onNextTick(()=>{c.maybeReportError(new F.LDUnexpectedResponseError(E.httpErrorMessage(x.status,"event posting","some events were dropped")))}))}))},o.start=function(){const C=()=>{o.flush(),b=setTimeout(C,m)};b=setTimeout(C,m)},o.stop=function(){clearTimeout(b)},o},ln=function(t){const n={},i={};return n.on=function(r,c,e){i[r]=i[r]||[],i[r]=i[r].concat({handler:c,context:e})},n.off=function(r,c,e){if(i[r])for(let o=0;o<i[r].length;o++)i[r][o].handler===c&&i[r][o].context===e&&(i[r]=i[r].slice(0,o).concat(i[r].slice(o+1)))},n.emit=function(r){if(!i[r])return;const c=i[r].slice(0);for(let e=0;e<c.length;e++)c[e].handler.apply(c[e].context,Array.prototype.slice.call(arguments,1))},n.getEvents=function(){return Object.keys(i)},n.getEventListenerCount=function(r){return i[r]?i[r].length:0},n.maybeReportError=function(r){r&&(i.error?this.emit("error",r):(t||console).error(r.message))},n};const vt="ready",At="initialized",jt="failed";var dn=function(t){let n=!1,i=!1,r=null,c=null;const e=new Promise(o=>{const a=()=>{t.off(vt,a),o()};t.on(vt,a)}).catch(()=>{});return{getInitializationPromise:()=>c||(n?Promise.resolve():i?Promise.reject(r):(c=new Promise((o,a)=>{const s=()=>{t.off(At,s),o()},u=l=>{t.off(jt,u),a(l)};t.on(At,s),t.on(jt,u)}),c)),getReadyPromise:()=>e,signalSuccess:()=>{n||i||(n=!0,t.emit(At),t.emit(vt))},signalFailure:o=>{n||i||(i=!0,r=o,t.emit(jt,o),t.emit(vt)),t.maybeReportError(o)}}},fn=function(t,n,i,r){const c={};function e(){let o="";const a=r.getContext();return a&&(o=i||D.btoa(JSON.stringify(a))),"ld:"+n+":"+o}return c.loadFlags=()=>t.get(e()).then(o=>{if(o==null)return null;try{let a=JSON.parse(o);if(a){const s=a.$schema;s===void 0||s<1?a=D.transformValuesToVersionedValues(a):delete a.$schema}return a}catch(a){return c.clearFlags().then(()=>null)}}),c.saveFlags=o=>{const a=D.extend({},o,{$schema:1});return t.set(e(),JSON.stringify(a))},c.clearFlags=()=>t.clear(e()),c},gn=function(t,n){const i={};let r=!1;const c=e=>{r||(r=!0,n.warn(E.localStorageUnavailable(e)))};return i.isEnabled=()=>!!t,i.get=e=>new Promise(o=>{t?t.get(e).then(o).catch(a=>{c(a),o(void 0)}):o(void 0)}),i.set=(e,o)=>new Promise(a=>{t?t.set(e,o).then(()=>a(!0)).catch(s=>{c(s),a(!1)}):a(!1)}),i.clear=e=>new Promise(o=>{t?t.clear(e).then(()=>o(!0)).catch(a=>{c(a),o(!1)}):o(!1)}),i};const{appendUrlPath:ge,base64URLEncode:vn,objectHasOwnProperty:pn}=D,{getLDHeaders:mn,transformHeaders:hn}=Tt,{isHttpErrorRecoverable:yn}=F;var wn=function(t,n,i,r){const c=n.streamUrl,e=n.logger,o={},a=ge(c,"/eval/"+i),s=n.useReport,u=n.evaluationReasons,l=n.streamReconnectDelay,d=mn(t,n);let g,m=!1,h=null,b=null,P=null,y=null,w=null,O=0;function T(){const x=(R=function(){const $=l*Math.pow(2,O);return $>3e4?3e4:$}(),R-Math.trunc(.5*Math.random()*R));var R;return O+=1,x}function S(x){if(x.status&&typeof x.status=="number"&&!yn(x.status))return A(),e.error(E.unrecoverableStreamError(x)),void(b&&(clearTimeout(b),b=null));const R=T();m||(e.warn(E.streamError(x,R)),m=!0),k(!1),A(),N(R)}function N(x){b||(x?b=setTimeout(C,x):C())}function C(){let x;b=null;let R="";const $={headers:d,readTimeoutMillis:3e5};if(t.eventSourceFactory){y!=null&&(R="h="+y),s?t.eventSourceAllowsReport?(x=a,$.method="REPORT",$.headers["Content-Type"]="application/json",$.body=JSON.stringify(P)):(x=ge(c,"/ping/"+i),R=""):x=a+"/"+vn(JSON.stringify(P)),$.headers=hn($.headers,n),u&&(R=R+(R?"&":"")+"withReasons=true"),x=x+(R?"?":"")+R,A(),e.info(E.streamConnecting(x)),g=new Date().getTime(),h=t.eventSourceFactory(x,$);for(const X in w)pn(w,X)&&h.addEventListener(X,w[X]);h.onerror=S,h.onopen=()=>{O=0}}}function A(){h&&(e.info(E.streamClosing()),h.close(),h=null)}function k(x){g&&r&&r.recordStreamInit(g,!x,new Date().getTime()-g),g=null}return o.connect=function(x,R,$){P=x,y=R,w={};for(const X in $||{})w[X]=function(W){m=!1,k(!0),$[X]&&$[X](W)};N()},o.disconnect=function(){clearTimeout(b),b=null,A()},o.isConnected=function(){return!!(h&&t.eventSourceIsActive&&t.eventSourceIsActive(h))},o},bn=function(t){let n,i,r,c;const e={addPromise:(o,a)=>{n=o,i&&i(),i=a,o.then(s=>{n===o&&(r(s),t&&t())},s=>{n===o&&(c(s),t&&t())})}};return e.resultPromise=new Promise((o,a)=>{r=o,c=a}),e};const{transformHeaders:kn,getLDHeaders:En}=Tt,Nt="application/json";var Dn=function(t,n,i){const r=n.baseUrl,c=n.useReport,e=n.evaluationReasons,o=n.logger,a={},s={};function u(l,d){if(!t.httpRequest)return new Promise((y,w)=>{w(new F.LDFlagFetchError(E.httpUnavailable()))});const g=d?"REPORT":"GET",m=En(t,n);d&&(m["Content-Type"]=Nt);let h=s[l];h||(h=bn(()=>{delete s[l]}),s[l]=h);const b=t.httpRequest(g,l,kn(m,n),d),P=b.promise.then(y=>{if(y.status===200){if(y.header("content-type")&&y.header("content-type").substring(0,Nt.length)===Nt)return JSON.parse(y.body);{const w=E.invalidContentType(y.header("content-type")||"");return Promise.reject(new F.LDFlagFetchError(w))}}return Promise.reject(function(w){return w.status===404?new F.LDInvalidEnvironmentIdError(E.environmentNotFound()):new F.LDFlagFetchError(E.errorFetchingFlags(w.statusText||String(w.status)))}(y))},y=>Promise.reject(new F.LDFlagFetchError(E.networkError(y))));return h.addPromise(P,()=>{b.cancel&&b.cancel()}),h.resultPromise}return a.fetchJSON=function(l){return u(D.appendUrlPath(r,l),null)},a.fetchFlagSettings=function(l,d){let g,m,h,b="";return c?(m=[r,"/sdk/evalx/",i,"/context"].join(""),h=JSON.stringify(l)):(g=D.base64URLEncode(JSON.stringify(l)),m=[r,"/sdk/evalx/",i,"/contexts/",g].join("")),d&&(b="h="+d),e&&(b=b+(b?"&":"")+"withReasons=true"),m=m+(b?"?":"")+b,o.debug(E.debugPolling(m)),u(m,h)},a},Cn=function(t,n){const i={};let r;return i.setContext=function(c){r=D.sanitizeContext(c),r&&n&&n(D.clone(r))},i.getContext=function(){return r?D.clone(r):null},t&&i.setContext(t),i};const{v1:xn}=It,{getContextKinds:Pn}=gt;var Sn=function(t){function n(r){return r==null||r==="user"?"ld:$anonUserId":`ld:$contextKey:${r}`}function i(r,c){return c.key!==null&&c.key!==void 0?(c.key=c.key.toString(),Promise.resolve(c)):c.anonymous?function(e){return t.get(n(e))}(r).then(e=>{if(e)return c.key=e,c;{const o=xn();return c.key=o,function(a,s){return t.set(n(s),a)}(o,r).then(()=>c)}}):Promise.reject(new F.LDInvalidUserError(E.invalidContext()))}this.processContext=r=>{if(!r)return Promise.reject(new F.LDInvalidUserError(E.contextNotSpecified()));const c=D.clone(r);if(r.kind==="multi"){const e=Pn(c);return Promise.all(e.map(o=>i(o,c[o]))).then(()=>c)}return i(r.kind,c)}};const{v1:In}=It,{baseOptionDefs:Ft}=Ut,{appendUrlPath:On}=D;var $t={DiagnosticId:function(t){const n={diagnosticId:In()};return t&&(n.sdkKeySuffix=t.length>6?t.substring(t.length-6):t),n},DiagnosticsAccumulator:function(t){let n,i,r,c;function e(o){n=o,i=0,r=0,c=[]}return e(t),{getProps:()=>({dataSinceDate:n,droppedEvents:i,eventsInLastBatch:r,streamInits:c}),setProps:o=>{n=o.dataSinceDate,i=o.droppedEvents||0,r=o.eventsInLastBatch||0,c=o.streamInits||[]},incrementDroppedEvents:()=>{i++},setEventsInLastBatch:o=>{r=o},recordStreamInit:(o,a,s)=>{const u={timestamp:o,failed:a,durationMillis:s};c.push(u)},reset:e}},DiagnosticsManager:function(t,n,i,r,c,e,o){const a=!!t.diagnosticUseCombinedEvent,s="ld:"+c+":$diagnostics",u=On(e.eventsUrl,"/events/diagnostic/"+c),l=e.diagnosticRecordingInterval,d=i;let g,m,h=!!e.streaming;const b={};function P(){return{sdk:O(),configuration:T(),platform:t.diagnosticPlatformData}}function y(S){e.logger&&e.logger.debug(E.debugPostingDiagnosticEvent(S)),r.sendEvents(S,u,!0).then(()=>{}).catch(()=>{})}function w(){y(function(){const S=new Date().getTime();let N={kind:a?"diagnostic-combined":"diagnostic",id:o,creationDate:S,...d.getProps()};return a&&(N={...N,...P()}),d.reset(S),N}()),m=setTimeout(w,l),g=new Date().getTime(),a&&function(){if(n.isEnabled()){const S={...d.getProps()};n.set(s,JSON.stringify(S))}}()}function O(){const S={...t.diagnosticSdkData};return e.wrapperName&&(S.wrapperName=e.wrapperName),e.wrapperVersion&&(S.wrapperVersion=e.wrapperVersion),S}function T(){return{customBaseURI:e.baseUrl!==Ft.baseUrl.default,customStreamURI:e.streamUrl!==Ft.streamUrl.default,customEventsURI:e.eventsUrl!==Ft.eventsUrl.default,eventsCapacity:e.eventCapacity,eventsFlushIntervalMillis:e.flushInterval,reconnectTimeMillis:e.streamReconnectDelay,streamingDisabled:!h,allAttributesPrivate:!!e.allAttributesPrivate,diagnosticRecordingIntervalMillis:e.diagnosticRecordingInterval,usingSecureMode:!!e.hash,bootstrapMode:!!e.bootstrap,fetchGoalsDisabled:!e.fetchGoals,sendEventsOnlyForVariation:!!e.sendEventsOnlyForVariation}}return b.start=()=>{a?function(S){if(!n.isEnabled())return S(!1);n.get(s).then(N=>{if(N)try{const C=JSON.parse(N);d.setProps(C),g=C.dataSinceDate}catch(C){}S(!0)}).catch(()=>{S(!1)})}(S=>{if(S){const N=(g||0)+l,C=new Date().getTime();C>=N?w():m=setTimeout(w,N-C)}else Math.floor(4*Math.random())===0?w():m=setTimeout(w,l)}):(y({kind:"diagnostic-init",id:o,creationDate:d.getProps().dataSinceDate,...P()}),m=setTimeout(w,l))},b.stop=()=>{m&&clearTimeout(m)},b.setStreaming=S=>{h=S},b}},Ln=function(t,n){let i=!1;const r={type:t.type,name:t.name,method:(...c)=>{try{t.method(...c)}catch(e){i||(i=!0,n.warn(E.inspectorMethodError(r.type,r.name)))}}};return r};const{onNextTick:pt}=D,B={flagUsed:"flag-used",flagDetailsChanged:"flag-details-changed",flagDetailChanged:"flag-detail-changed",clientIdentityChanged:"client-identity-changed"};Object.freeze(B);var Un={InspectorTypes:B,InspectorManager:function(t,n){const i={},r={[B.flagUsed]:[],[B.flagDetailsChanged]:[],[B.flagDetailChanged]:[],[B.clientIdentityChanged]:[]},c=t&&t.map(e=>Ln(e,n));return c&&c.forEach(e=>{Object.prototype.hasOwnProperty.call(r,e.type)?r[e.type].push(e):n.warn(E.invalidInspector(e.type,e.name))}),i.hasListeners=e=>r[e]&&r[e].length,i.onFlagUsed=(e,o,a)=>{r[B.flagUsed].length&&pt(()=>{r[B.flagUsed].forEach(s=>s.method(e,o,a))})},i.onFlags=e=>{r[B.flagDetailsChanged].length&&pt(()=>{r[B.flagDetailsChanged].forEach(o=>o.method(e))})},i.onFlagChanged=(e,o)=>{r[B.flagDetailChanged].length&&pt(()=>{r[B.flagDetailChanged].forEach(a=>a.method(e,o))})},i.onIdentityChanged=e=>{r[B.clientIdentityChanged].length&&pt(()=>{r[B.clientIdentityChanged].forEach(o=>o.method(e))})},i}};const{commonBasicLogger:ve}=Ot,{checkContext:Tn,getContextKeys:Rn}=gt,{InspectorTypes:mt,InspectorManager:An}=Un,st="change",pe="internal-change";var ht={initialize:function(t,n,i,r,c){const e=function(){return i&&i.logger?i.logger:c&&c.logger&&c.logger.default||ve("warn")}(),o=ln(e),a=dn(o),s=Ut.validate(i,o,c,e),u=An(s.inspectors,e),l=s.sendEvents;let d=t,g=s.hash;const m=gn(r.localStorage,e),h=ie(r,d,s),b=s.sendEvents&&!s.diagnosticOptOut,P=b?$t.DiagnosticId(d):null,y=b?$t.DiagnosticsAccumulator(new Date().getTime()):null,w=b?$t.DiagnosticsManager(r,m,y,h,d,s,P):null,O=wn(r,s,d,y),T=s.eventProcessor||un(r,s,d,y,o,h),S=Dn(r,s,d);let N,C,A,k={},x=s.streaming,R=!1,$=!1,X=!0;const W=s.stateProvider,V=Cn(null,function(f){(function(p){W||p&&wt({kind:"identify",context:p,creationDate:new Date().getTime()})})(f),u.hasListeners(mt.clientIdentityChanged)&&u.onIdentityChanged(V.getContext())}),ke=new Sn(m),rt=m.isEnabled()?fn(m,d,g,V):null;function wt(f){d&&(W&&W.enqueueEvent&&W.enqueueEvent(f)||(f.context?(X=!1,!l||$||r.isDoNotTrack()||(e.debug(E.debugEnqueueingEvent(f.kind)),T.enqueue(f))):X&&(e.warn(E.eventWithoutContext()),X=!1)))}function Ee(f,p){u.hasListeners(mt.flagDetailChanged)&&u.onFlagChanged(f.key,ot(p))}function De(){u.hasListeners(mt.flagDetailsChanged)&&u.onFlags(Object.entries(k).map(([f,p])=>({key:f,detail:ot(p)})).reduce((f,p)=>(f[p.key]=p.detail,f),{}))}function Ce(f,p,v,I){const L=V.getContext(),j=new Date,U={kind:"feature",key:f,context:L,value:p?p.value:null,variation:p?p.variationIndex:null,default:v,creationDate:j.getTime()},z=k[f];z&&(U.version=z.flagVersion?z.flagVersion:z.version,U.trackEvents=z.trackEvents,U.debugEventsUntilDate=z.debugEventsUntilDate),(I||z&&z.trackReason)&&p&&(U.reason=p.reason),wt(U)}function xe(f){return Tn(f,!1)?Promise.resolve(f):Promise.reject(new F.LDInvalidUserError(E.invalidContext()))}function Mt(f,p,v,I,L){let j;if(k&&D.objectHasOwnProperty(k,f)&&k[f]&&!k[f].deleted){const U=k[f];j=ot(U),U.value!==null&&U.value!==void 0||(j.value=p)}else j={value:p,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return v&&Ce(f,j,p,I),L||function(U,z){u.hasListeners(mt.flagUsed)&&u.onFlagUsed(U,z,V.getContext())}(f,j),j}function ot(f){return{value:f.value,variationIndex:f.variation===void 0?null:f.variation,reason:f.reason||null}}function Pe(){if(C=!0,!V.getContext())return;const f=p=>{try{return JSON.parse(p)}catch(v){return void o.maybeReportError(new F.LDInvalidDataError(E.invalidData()))}};O.connect(V.getContext(),g,{ping:function(){e.debug(E.debugStreamPing());const p=V.getContext();S.fetchFlagSettings(p,g).then(v=>{D.deepEquals(p,V.getContext())&&it(v||{})}).catch(v=>{o.maybeReportError(new F.LDFlagFetchError(E.errorFetchingFlags(v)))})},put:function(p){const v=f(p.data);v&&(e.debug(E.debugStreamPut()),it(v))},patch:function(p){const v=f(p.data);if(!v)return;const I=k[v.key];if(!I||!I.version||!v.version||I.version<v.version){e.debug(E.debugStreamPatch(v.key));const L={},j=D.extend({},v);delete j.key,k[v.key]=j;const U=ot(j);L[v.key]=I?{previous:I.value,current:U}:{current:U},Kt(L),Ee(v,j)}else e.debug(E.debugStreamPatchIgnored(v.key))},delete:function(p){const v=f(p.data);if(v)if(!k[v.key]||k[v.key].version<v.version){e.debug(E.debugStreamDelete(v.key));const I={};k[v.key]&&!k[v.key].deleted&&(I[v.key]={previous:k[v.key].value}),k[v.key]={version:v.version,deleted:!0},Ee(v,k[v.key]),Kt(I)}else e.debug(E.debugStreamDeleteIgnored(v.key))}})}function qt(){C&&(O.disconnect(),C=!1)}function it(f){const p={};if(!f)return Promise.resolve();for(const v in k)D.objectHasOwnProperty(k,v)&&k[v]&&(f[v]&&!D.deepEquals(f[v].value,k[v].value)?p[v]={previous:k[v].value,current:ot(f[v])}:f[v]&&!f[v].deleted||(p[v]={previous:k[v].value}));for(const v in f)D.objectHasOwnProperty(f,v)&&f[v]&&(!k[v]||k[v].deleted)&&(p[v]={current:ot(f[v])});return k={...f},De(),Kt(p).catch(()=>{})}function Kt(f){const p=Object.keys(f);if(p.length>0){const v={};p.forEach(I=>{const L=f[I].current,j=L?L.value:void 0,U=f[I].previous;o.emit(st+":"+I,j,U),v[I]=L?{current:j,previous:U}:{previous:U}}),o.emit(st,v),o.emit(pe,k),s.sendEventsOnlyForVariation||W||p.forEach(I=>{Ce(I,f[I].current)})}return N&&rt?rt.saveFlags(k):Promise.resolve()}function Jt(){const f=x||A&&x===void 0;f&&!C?Pe():!f&&C&&qt(),w&&w.setStreaming(f)}function zt(f){return f===st||f.substr(0,st.length+1)===st+":"}if(typeof s.bootstrap=="string"&&s.bootstrap.toUpperCase()==="LOCALSTORAGE"&&(rt?N=!0:e.warn(E.localStorageUnavailable())),typeof s.bootstrap=="object"&&(k=function(f){const p=Object.keys(f),v="$flagsState",I="$valid",L=f[v];!L&&p.length&&e.warn(E.bootstrapOldFormat()),f[I]===!1&&e.warn(E.bootstrapInvalid());const j={};return p.forEach(U=>{if(U!==v&&U!==I){let z={value:f[U]};L&&L[U]?z=D.extend(z,L[U]):z.version=0,j[U]=z}}),j}(s.bootstrap)),W){const f=W.getInitialState();f?Se(f):W.on("init",Se),W.on("update",function(p){p.context&&V.setContext(p.context),p.flags&&it(p.flags)})}else(function(){return t?ke.processContext(n).then(xe).then(f=>(V.setContext(f),typeof s.bootstrap=="object"?ct():N?rt.loadFlags().then(p=>p==null?(k={},S.fetchFlagSettings(V.getContext(),g).then(v=>it(v||{})).then(ct).catch(v=>{Bt(new F.LDFlagFetchError(E.errorFetchingFlags(v)))})):(k=p,D.onNextTick(ct),S.fetchFlagSettings(V.getContext(),g).then(v=>it(v)).catch(v=>o.maybeReportError(v)))):S.fetchFlagSettings(V.getContext(),g).then(p=>{k=p||{},De(),ct()}).catch(p=>{k={},Bt(p)}))):Promise.reject(new F.LDInvalidEnvironmentIdError(E.environmentNotSpecified()))})().catch(Bt);function Se(f){d=f.environment,V.setContext(f.context),k={...f.flags},D.onNextTick(ct)}function ct(){e.info(E.clientInitialized()),R=!0,Jt(),a.signalSuccess()}function Bt(f){a.signalFailure(f)}return{client:{waitForInitialization:()=>a.getInitializationPromise(),waitUntilReady:()=>a.getReadyPromise(),identify:function(f,p,v){if($)return D.wrapPromiseCallback(Promise.resolve({}),v);if(W)return e.warn(E.identifyDisabled()),D.wrapPromiseCallback(Promise.resolve(D.transformVersionedValuesToValues(k)),v);const I=N&&rt?rt.clearFlags():Promise.resolve();return D.wrapPromiseCallback(I.then(()=>ke.processContext(f)).then(xe).then(L=>S.fetchFlagSettings(L,p).then(j=>{const U=D.transformVersionedValuesToValues(j);return V.setContext(L),g=p,j?it(j).then(()=>U):U})).then(L=>(C&&Pe(),L)).catch(L=>(o.maybeReportError(L),Promise.reject(L))),v)},getContext:function(){return V.getContext()},variation:function(f,p){return Mt(f,p,!0,!1,!1).value},variationDetail:function(f,p){return Mt(f,p,!0,!0,!1)},track:function(f,p,v){if(typeof f!="string")return void o.maybeReportError(new F.LDInvalidEventKeyError(E.unknownCustomEventKey(f)));r.customEventFilter&&!r.customEventFilter(f)&&e.warn(E.unknownCustomEventKey(f));const I=V.getContext(),L={kind:"custom",key:f,context:I,url:r.getCurrentUrl(),creationDate:new Date().getTime()};I&&I.anonymous&&(L.contextKind=I.anonymous?"anonymousUser":"user"),p!=null&&(L.data=p),v!=null&&(L.metricValue=v),wt(L)},on:function(f,p,v){zt(f)?(A=!0,R&&Jt(),o.on(f,p,v)):o.on(...arguments)},off:function(f){if(o.off(...arguments),zt(f)){let p=!1;o.getEvents().forEach(v=>{zt(v)&&o.getEventListenerCount(v)>0&&(p=!0)}),p||(A=!1,C&&x===void 0&&qt())}},setStreaming:function(f){const p=f===null?void 0:f;p!==x&&(x=p,Jt())},flush:function(f){return D.wrapPromiseCallback(l?T.flush():Promise.resolve(),f)},allFlags:function(){const f={};if(!k)return f;for(const p in k)D.objectHasOwnProperty(k,p)&&!k[p].deleted&&(f[p]=Mt(p,null,!s.sendEventsOnlyForVariation,!1,!0).value);return f},close:function(f){if($)return D.wrapPromiseCallback(Promise.resolve(),f);const p=()=>{$=!0,k={}},v=Promise.resolve().then(()=>{if(qt(),w&&w.stop(),l)return T.stop(),T.flush()}).then(p).catch(p);return D.wrapPromiseCallback(v,f)}},options:s,emitter:o,ident:V,logger:e,requestor:S,start:function(){l&&(w&&w.start(),T.start())},enqueueEvent:wt,getFlagsInternal:function(){return k},getEnvironmentId:()=>d,internalChangeEventName:pe}},commonBasicLogger:ve,errors:F,messages:E,utils:D,getContextKeys:Rn},jn=ht.initialize,Nn=ht.errors,Fn=ht.messages;function me(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),i.push.apply(i,r)}return i}function Vt(t){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?me(Object(i),!0).forEach(function(r){$n(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function $n(t,n,i){return(n=function(r){var c=function(e,o){if(typeof e!="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,o||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(e)}(r,"string");return typeof c=="symbol"?c:String(c)}(n))in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}var Vn=ht.commonBasicLogger,Hn=function(t){return Vn(Vt({destination:console.log},t))},he={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function Mn(t,n,i,r,c){if(c&&!function(){var u=window.navigator&&window.navigator.userAgent;if(u){var l=u.match(/Chrom(e|ium)\/([0-9]+)\./);if(l)return parseInt(l[2],10)<73}return!0}())return he;var e=new window.XMLHttpRequest;for(var o in e.open(t,n,!c),i||{})Object.prototype.hasOwnProperty.call(i,o)&&e.setRequestHeader(o,i[o]);if(c)return e.send(r),he;var a,s=new Promise(function(u,l){e.addEventListener("load",function(){a||u({status:e.status,header:function(d){return e.getResponseHeader(d)},body:e.responseText})}),e.addEventListener("error",function(){a||l(new Error)}),e.send(r)});return{promise:s,cancel:function(){a=!0,e.abort()}}}var Ht=t=>{if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};function qn(t,n,i,r){var c,e,o=((t.kind==="substring"||t.kind==="regex")&&r.includes("/")?n:n.replace(r,"")).replace(i,"");switch(t.kind){case"exact":e=n,c=new RegExp("^"+Ht(t.url)+"/?$");break;case"canonical":e=o,c=new RegExp("^"+Ht(t.url)+"/?$");break;case"substring":e=o,c=new RegExp(".*"+Ht(t.substring)+".*$");break;case"regex":e=o,c=new RegExp(t.pattern);break;default:return!1}return c.test(e)}function ye(t,n){for(var i={},r=null,c=[],e=0;e<t.length;e++)for(var o=t[e],a=o.urls||[],s=0;s<a.length;s++)if(qn(a[s],window.location.href,window.location.search,window.location.hash)){o.kind==="pageview"?n("pageview",o):(c.push(o),n("click_pageview",o));break}return c.length>0&&(r=function(u){for(var l=function(g,m){for(var h=[],b=0;b<m.length;b++)for(var P=g.target,y=m[b],w=y.selector,O=document.querySelectorAll(w);P&&O.length>0;){for(var T=0;T<O.length;T++)P===O[T]&&h.push(y);P=P.parentNode}return h}(u,c),d=0;d<l.length;d++)n("click",l[d])},document.addEventListener("click",r)),i.dispose=function(){document.removeEventListener("click",r)},i}var Kn=300;function Jn(t,n){var i,r;function c(){r&&r.dispose(),i&&i.length&&(r=ye(i,e))}function e(o,a){var s=t.ident.getContext(),u={kind:o,key:a.key,data:null,url:window.location.href,creationDate:new Date().getTime(),context:s};return o==="click"&&(u.selector=a.selector),t.enqueueEvent(u)}return t.requestor.fetchJSON("/sdk/goals/"+t.getEnvironmentId()).then(function(o){o&&o.length>0&&(r=ye(i=o,e),function(a,s){var u,l=window.location.href;function d(){(u=window.location.href)!==l&&(l=u,s())}(function g(m,h){m(),setTimeout(function(){g(m,h)},h)})(d,a),window.history&&window.history.pushState?window.addEventListener("popstate",d):window.addEventListener("hashchange",d)}(Kn,c)),n()}).catch(function(o){t.emitter.maybeReportError(new Nn.LDUnexpectedResponseError((o&&o.message,o.message))),n()}),{}}var yt="goalsReady",zn={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function we(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=function(l){var d,g={userAgentHeaderName:"X-LaunchDarkly-User-Agent",synchronousFlush:!1};if(window.XMLHttpRequest){var m=l&&l.disableSyncEventPost;g.httpRequest=function(y,w,O,T){var S=g.synchronousFlush&!m;return g.synchronousFlush=!1,Mn(y,w,O,T,S)}}g.httpAllowsPost=function(){return d===void 0&&(d=!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest),d},g.httpFallbackPing=function(y){new window.Image().src=y};var h,b=l&&l.eventUrlTransformer;g.getCurrentUrl=function(){return b?b(window.location.href):window.location.href},g.isDoNotTrack=function(){var y;return(y=window.navigator&&window.navigator.doNotTrack!==void 0?window.navigator.doNotTrack:window.navigator&&window.navigator.msDoNotTrack!==void 0?window.navigator.msDoNotTrack:window.doNotTrack)===1||y===!0||y==="1"||y==="yes"};try{window.localStorage&&(g.localStorage={get:function(y){return new Promise(function(w){w(window.localStorage.getItem(y))})},set:function(y,w){return new Promise(function(O){window.localStorage.setItem(y,w),O()})},clear:function(y){return new Promise(function(w){window.localStorage.removeItem(y),w()})}})}catch(y){g.localStorage=null}if(l&&l.useReport&&typeof window.EventSourcePolyfill=="function"&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(g.eventSourceAllowsReport=!0,h=window.EventSourcePolyfill):(g.eventSourceAllowsReport=!1,h=window.EventSource),window.EventSource){var P=3e5;g.eventSourceFactory=function(y,w){var O=Vt(Vt({},{heartbeatTimeout:P,silentTimeout:P,skipDefaultHeaders:!0}),w);return new h(y,O)},g.eventSourceIsActive=function(y){return y.readyState===window.EventSource.OPEN||y.readyState===window.EventSource.CONNECTING}}return g.userAgent="JSClient",g.version="3.1.3",g.diagnosticSdkData={name:"js-client-sdk",version:"3.1.3"},g.diagnosticPlatformData={name:"JS"},g.diagnosticUseCombinedEvent=!0,g}(i),c=jn(t,n,i,r,zn),e=c.client,o=c.options,a=c.emitter,s=new Promise(function(l){var d=a.on(yt,function(){a.off(yt,d),l()})});e.waitUntilGoalsReady=function(){return s},o.fetchGoals?Jn(c,function(){return a.emit(yt)}):a.emit(yt),document.readyState!=="complete"?window.addEventListener("load",c.start):c.start();var u=function(){r.synchronousFlush=!0,e.flush().catch(function(){}),r.synchronousFlush=!1};return document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&u()}),window.addEventListener("pagehide",u),e}var Bn=Hn,Gn=void 0,be="3.1.3",Wn={initialize:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return console&&console.warn&&console.warn(Fn.deprecated("default export","named LDClient export")),we(t,n,i)},version:be}}}]);
